{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/4th%20year/InnerGuide-Digital/lib/socket.ts"],"sourcesContent":["import { Server as HTTPServer } from 'http';\r\nimport { Socket as ServerSocket, Server } from 'socket.io';\r\n\r\nexport interface ClientSocket extends ServerSocket {\r\n  userId?: string;\r\n}\r\n\r\nlet io: Server;\r\n\r\nexport const initSocket = (httpServer: HTTPServer) => {\r\n  io = new Server(httpServer, {\r\n    cors: {\r\n      origin: process.env.NODE_ENV === 'production' \r\n        ? process.env.NEXT_PUBLIC_BASE_URL \r\n        : 'http://localhost:3000',\r\n      credentials: true,\r\n    },\r\n  });\r\n\r\n  io.on('connection', (socket: ClientSocket) => {\r\n    console.log('[Socket.io] User connected:', socket.id);\r\n\r\n    socket.on('user:join', (userId: string) => {\r\n      socket.userId = userId;\r\n      socket.join(`user:${userId}`);\r\n      console.log('[Socket.io] User joined room:', `user:${userId}`);\r\n    });\r\n\r\n    socket.on('booking:created', (data) => {\r\n      io.to(`user:${data.counselorId}`).emit('notification:new', {\r\n        type: 'booking',\r\n        message: 'New appointment booking received',\r\n        data,\r\n      });\r\n    });\r\n\r\n    socket.on('forum:reply', (data) => {\r\n      io.to(`thread:${data.threadId}`).emit('notification:thread', {\r\n        type: 'new_reply',\r\n        message: 'New reply in discussion',\r\n        data,\r\n      });\r\n    });\r\n\r\n    socket.on('counselor:status', (data) => {\r\n      io.emit('status:updated', {\r\n        counselorId: data.counselorId,\r\n        status: data.status,\r\n      });\r\n    });\r\n\r\n    socket.on('disconnect', () => {\r\n      console.log('[Socket.io] User disconnected:', socket.id);\r\n    });\r\n  });\r\n\r\n  return io;\r\n};\r\n\r\nexport const getIO = () => {\r\n  if (!io) {\r\n    throw new Error('Socket.io not initialized');\r\n  }\r\n  return io;\r\n};\r\n"],"names":[],"mappings":";;;;;;AACA;;AAMA,IAAI;AAEG,MAAM,aAAa,CAAC;IACzB,KAAK,IAAI,oJAAM,CAAC,YAAY;QAC1B,MAAM;YACJ,QAAQ,sCACJ,0BACA;YACJ,aAAa;QACf;IACF;IAEA,GAAG,EAAE,CAAC,cAAc,CAAC;QACnB,QAAQ,GAAG,CAAC,+BAA+B,OAAO,EAAE;QAEpD,OAAO,EAAE,CAAC,aAAa,CAAC;YACtB,OAAO,MAAM,GAAG;YAChB,OAAO,IAAI,CAAC,CAAC,KAAK,EAAE,QAAQ;YAC5B,QAAQ,GAAG,CAAC,iCAAiC,CAAC,KAAK,EAAE,QAAQ;QAC/D;QAEA,OAAO,EAAE,CAAC,mBAAmB,CAAC;YAC5B,GAAG,EAAE,CAAC,CAAC,KAAK,EAAE,KAAK,WAAW,EAAE,EAAE,IAAI,CAAC,oBAAoB;gBACzD,MAAM;gBACN,SAAS;gBACT;YACF;QACF;QAEA,OAAO,EAAE,CAAC,eAAe,CAAC;YACxB,GAAG,EAAE,CAAC,CAAC,OAAO,EAAE,KAAK,QAAQ,EAAE,EAAE,IAAI,CAAC,uBAAuB;gBAC3D,MAAM;gBACN,SAAS;gBACT;YACF;QACF;QAEA,OAAO,EAAE,CAAC,oBAAoB,CAAC;YAC7B,GAAG,IAAI,CAAC,kBAAkB;gBACxB,aAAa,KAAK,WAAW;gBAC7B,QAAQ,KAAK,MAAM;YACrB;QACF;QAEA,OAAO,EAAE,CAAC,cAAc;YACtB,QAAQ,GAAG,CAAC,kCAAkC,OAAO,EAAE;QACzD;IACF;IAEA,OAAO;AACT;AAEO,MAAM,QAAQ;IACnB,IAAI,CAAC,IAAI;QACP,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}}]
}