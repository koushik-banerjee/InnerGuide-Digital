{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/4th%20year/InnerGuide-Digital/lib/mongodb.ts"],"sourcesContent":["import mongoose from 'mongoose';\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI || 'mongodb://localhost:27017/mental-health-app';\r\n\r\nif (!MONGODB_URI) {\r\n  throw new Error('Please define the MONGODB_URI environment variable');\r\n}\r\n\r\nlet cached = global.mongoose;\r\n\r\nif (!cached) {\r\n  cached = global.mongoose = { conn: null, promise: null };\r\n}\r\n\r\nexport async function connectToDatabase() {\r\n  if (cached.conn) {\r\n    return cached.conn;\r\n  }\r\n\r\n  if (!cached.promise) {\r\n    const opts = {\r\n      bufferCommands: false,\r\n    };\r\n\r\n    cached.promise = mongoose\r\n      .connect(MONGODB_URI, opts)\r\n      .then((mongoose) => {\r\n        return mongoose;\r\n      });\r\n  }\r\n\r\n  try {\r\n    cached.conn = await cached.promise;\r\n  } catch (e) {\r\n    cached.promise = null;\r\n    throw e;\r\n  }\r\n\r\n  return cached.conn;\r\n}\r\n\r\ndeclare global {\r\n  var mongoose: any;\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAE/C;;AAIA,IAAI,SAAS,yDAAO,QAAQ;AAE5B,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACzD;AAEO,eAAe;IACpB,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,oHAAQ,CACtB,OAAO,CAAC,aAAa,MACrB,IAAI,CAAC,CAAC;YACL,OAAO;QACT;IACJ;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/4th%20year/InnerGuide-Digital/models/ForumThread.ts"],"sourcesContent":["import mongoose, { Schema, Document } from 'mongoose';\r\n\r\nexport interface IForumThread extends Document {\r\n  title: string;\r\n  description: string;\r\n  category: 'anxiety' | 'depression' | 'stress' | 'relationships' | 'academic' | 'identity' | 'other';\r\n  authorId: string;\r\n  authorName: string;\r\n  content: string;\r\n  tags: string[];\r\n  replies: Array<{\r\n    _id: string;\r\n    authorId: string;\r\n    authorName: string;\r\n    content: string;\r\n    isVolunteer: boolean;\r\n    createdAt: Date;\r\n  }>;\r\n  status: 'active' | 'archived' | 'moderated';\r\n  isPinned: boolean;\r\n  views: number;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nconst forumThreadSchema = new Schema<IForumThread>(\r\n  {\r\n    title: { type: String, required: true },\r\n    description: String,\r\n    category: {\r\n      type: String,\r\n      enum: ['anxiety', 'depression', 'stress', 'relationships', 'academic', 'identity', 'other'],\r\n      default: 'other',\r\n    },\r\n    authorId: {\r\n      type: Schema.Types.ObjectId,\r\n      ref: 'User',\r\n      required: true,\r\n    },\r\n    authorName: String,\r\n    content: { type: String, required: true },\r\n    tags: [String],\r\n    replies: [\r\n      {\r\n        authorId: {\r\n          type: Schema.Types.ObjectId,\r\n          ref: 'User',\r\n        },\r\n        authorName: String,\r\n        content: String,\r\n        isVolunteer: { type: Boolean, default: false },\r\n        createdAt: { type: Date, default: Date.now },\r\n      },\r\n    ],\r\n    status: {\r\n      type: String,\r\n      enum: ['active', 'archived', 'moderated'],\r\n      default: 'active',\r\n    },\r\n    isPinned: { type: Boolean, default: false },\r\n    views: { type: Number, default: 0 },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nexport const ForumThread = mongoose.models.ForumThread || mongoose.model<IForumThread>('ForumThread', forumThreadSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAyBA,MAAM,oBAAoB,IAAI,mHAAM,CAClC;IACE,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,aAAa;IACb,UAAU;QACR,MAAM;QACN,MAAM;YAAC;YAAW;YAAc;YAAU;YAAiB;YAAY;YAAY;SAAQ;QAC3F,SAAS;IACX;IACA,UAAU;QACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;IACZ;IACA,YAAY;IACZ,SAAS;QAAE,MAAM;QAAQ,UAAU;IAAK;IACxC,MAAM;QAAC;KAAO;IACd,SAAS;QACP;YACE,UAAU;gBACR,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;gBAC3B,KAAK;YACP;YACA,YAAY;YACZ,SAAS;YACT,aAAa;gBAAE,MAAM;gBAAS,SAAS;YAAM;YAC7C,WAAW;gBAAE,MAAM;gBAAM,SAAS,KAAK,GAAG;YAAC;QAC7C;KACD;IACD,QAAQ;QACN,MAAM;QACN,MAAM;YAAC;YAAU;YAAY;SAAY;QACzC,SAAS;IACX;IACA,UAAU;QAAE,MAAM;QAAS,SAAS;IAAM;IAC1C,OAAO;QAAE,MAAM;QAAQ,SAAS;IAAE;AACpC,GACA;IAAE,YAAY;AAAK;AAGd,MAAM,cAAc,oHAAQ,CAAC,MAAM,CAAC,WAAW,IAAI,oHAAQ,CAAC,KAAK,CAAe,eAAe"}},
    {"offset": {"line": 185, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/4th%20year/InnerGuide-Digital/lib/auth.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\r\n\r\nexport interface JWTPayload {\r\n  userId: string;\r\n  email: string;\r\n  role: 'student' | 'counselor' | 'admin';\r\n}\r\n\r\nexport const generateToken = (payload: JWTPayload): string => {\r\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: '7d' });\r\n};\r\n\r\nexport const verifyToken = (token: string): JWTPayload | null => {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET) as JWTPayload;\r\n  } catch (error) {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const decodeToken = (token: string): JWTPayload | null => {\r\n  try {\r\n    return jwt.decode(token) as JWTPayload;\r\n  } catch (error) {\r\n    return null;\r\n  }\r\n};\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAQtC,MAAM,gBAAgB,CAAC;IAC5B,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AACzD;AAEO,MAAM,cAAc,CAAC;IAC1B,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,MAAM,cAAc,CAAC;IAC1B,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC;IACpB,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF"}},
    {"offset": {"line": 225, "column": 0}, "map": {"version":3,"sources":["file:///D:/work/4th%20year/InnerGuide-Digital/app/api/forum/threads/route.ts"],"sourcesContent":["import { connectToDatabase } from '@/lib/mongodb';\r\nimport { ForumThread } from '@/models/ForumThread';\r\nimport { verifyToken } from '@/lib/auth';\r\nimport { NextResponse } from 'next/server';\r\n\r\nexport async function GET(request: Request) {\r\n  try {\r\n    await connectToDatabase();\r\n\r\n    const { searchParams } = new URL(request.url);\r\n    const category = searchParams.get('category');\r\n    const page = parseInt(searchParams.get('page') || '1');\r\n    const limit = 10;\r\n\r\n    let query: any = { status: 'active' };\r\n    if (category) query.category = category;\r\n\r\n    const threads = await ForumThread.find(query)\r\n      .limit(limit)\r\n      .skip((page - 1) * limit)\r\n      .sort({ isPinned: -1, createdAt: -1 });\r\n\r\n    const total = await ForumThread.countDocuments(query);\r\n\r\n    return NextResponse.json(\r\n      {\r\n        threads,\r\n        pagination: {\r\n          page,\r\n          limit,\r\n          total,\r\n          pages: Math.ceil(total / limit),\r\n        },\r\n      },\r\n      { status: 200 }\r\n    );\r\n  } catch (error) {\r\n    console.error('Fetch threads error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Failed to fetch threads' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n  try {\r\n    await connectToDatabase();\r\n\r\n    const authHeader = request.headers.get('authorization');\r\n    if (!authHeader) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const token = authHeader.split(' ')[1];\r\n    const decoded = verifyToken(token);\r\n    if (!decoded) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid token' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const body = await request.json();\r\n    const { title, description, content, category, tags } = body;\r\n\r\n    if (!title || !content) {\r\n      return NextResponse.json(\r\n        { error: 'Title and content required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const thread = new ForumThread({\r\n      title,\r\n      description,\r\n      content,\r\n      category,\r\n      tags,\r\n      authorId: decoded.userId,\r\n      authorName: decoded.email,\r\n    });\r\n\r\n    await thread.save();\r\n\r\n    return NextResponse.json({ thread }, { status: 201 });\r\n  } catch (error) {\r\n    console.error('Create thread error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Failed to create thread' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,IAAA,qIAAiB;QAEvB,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,WAAW,aAAa,GAAG,CAAC;QAClC,MAAM,OAAO,SAAS,aAAa,GAAG,CAAC,WAAW;QAClD,MAAM,QAAQ;QAEd,IAAI,QAAa;YAAE,QAAQ;QAAS;QACpC,IAAI,UAAU,MAAM,QAAQ,GAAG;QAE/B,MAAM,UAAU,MAAM,sIAAW,CAAC,IAAI,CAAC,OACpC,KAAK,CAAC,OACN,IAAI,CAAC,CAAC,OAAO,CAAC,IAAI,OAClB,IAAI,CAAC;YAAE,UAAU,CAAC;YAAG,WAAW,CAAC;QAAE;QAEtC,MAAM,QAAQ,MAAM,sIAAW,CAAC,cAAc,CAAC;QAE/C,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE;YACA,YAAY;gBACV;gBACA;gBACA;gBACA,OAAO,KAAK,IAAI,CAAC,QAAQ;YAC3B;QACF,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA0B,GACnC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,IAAA,qIAAiB;QAEvB,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;QACvC,IAAI,CAAC,YAAY;YACf,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,WAAW,KAAK,CAAC,IAAI,CAAC,EAAE;QACtC,MAAM,UAAU,IAAA,4HAAW,EAAC;QAC5B,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAgB,GACzB;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG;QAExD,IAAI,CAAC,SAAS,CAAC,SAAS;YACtB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA6B,GACtC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,IAAI,sIAAW,CAAC;YAC7B;YACA;YACA;YACA;YACA;YACA,UAAU,QAAQ,MAAM;YACxB,YAAY,QAAQ,KAAK;QAC3B;QAEA,MAAM,OAAO,IAAI;QAEjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAO,GAAG;YAAE,QAAQ;QAAI;IACrD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA0B,GACnC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}